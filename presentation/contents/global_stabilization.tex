\section{Global stabilization}

\begin{theorem}\label{thm:global-stabilization}
    For all $M \in \Real_{>0}$ there exists smooth control $u(t)$ such that $|u(t)| < M$ for all $t \in \Real_{\geq 0 }$ and 
    \[
        \Exp \|\Boldy(t)\|^2 - \Exp \|\Boldy(s)\|^2 \leq \int_s^t  - \frac{\gamma \nu }{2} \Exp \|\Boldy(\tau)\|^2   + \sum_{i=1}^N \Exp \left[ \frac{\sigma_i(\Boldy(\tau))^2}{2} \right] d\tau 
    \]
\end{theorem}

\begin{proof}
    We consider the control function\footnote{The control function in \cite{leader_hk} has a similar form}
    \[
        u(t) = \alpha(t) \sum_{j=1}^N c_j y_j(t)
    \]
    where $\alpha(t)$ is smooth function of $y_1(t), \ldots, y_N(t)$ such that 
    \[
        \frac{1}{4} \min \left\{\frac{\gamma\phi\left( \max_{i}\left|y_i(t)\right|\right)}{N  \sum_{j=1}^N c_j}, \frac{2 M}{\gamma \sum_i\left|y_i(t)\right|}\right\} \leq \alpha(t) \leq \frac{1}{2} \min \left\{\frac{\gamma\phi\left( \max_{i}\left|y_i(t)\right|\right)}{N  \sum_{j=1}^N c_j}, \frac{2 M}{\gamma \sum_i\left|y_i(t)\right|}\right\} .
    \]
    Note that $u(t)$ is indeed bounded
    \[
        |u(t)| \leq  \alpha(t) \sum_{j=1}^N c_j |y_j(t)| \leq \alpha(t)  \sum_{j=1}^N \gamma |y_j(t)| \leq M
    \]
    Let us apply the Ito's lemma for $\|\Boldy(t)\|^2 = y_1^2(t) + \ldots + y_N^2(t)$:
    \begin{multline*}
        \|\Boldy(t)\|^2 -  \|\Boldy(s)\|^2 = \\ \sum_{i=1}^N\int_s^t \left[ \left(-u(\tau) + \sum_{j=1}^N a_{i j}\left(y_j(\tau)-y_i(\tau)\right)-c_i y_i(\tau)\right) y_i(\tau) + 
        \frac{\sigma_i(\Boldy(t))^2}{2} \right]d\tau + \\ 
        \sum_{i=1}^N  \int_s^{t}\sigma_i(\Boldy(\tau)) y_i(\tau) dW_{\tau}^i
    \end{multline*}
    The expected value of it
    \begin{multline}\label{eq:ExpIto}
        \Exp \|\Boldy(t)\|^2 -  \Exp \|\Boldy(s)\|^2 =  \sum_{i=1}^N \Exp \left[\int_s^t \left(-u(\tau) + \sum_{j=1}^N a_{i j}\left(y_j(\tau)-y_i(\tau)\right)-c_i y_i(\tau)\right) y_i(\tau) d\tau \right] + \\
        \sum_{i=1}^N \Exp \left[ \int_s^{t} \frac{\sigma_i(\Boldy(\tau))^2}{2} d\tau\right] + 0
    \end{multline}
    Let us consider separately
    \[
        \sum_{i=1}^N \Exp \left[\int_s^t \left(-u(\tau) + \sum_{j=1}^N a_{i j}\left(y_j(\tau)-y_i(\tau)\right)-c_i y_i(\tau)\right) y_i(\tau) d\tau \right]
    \]
    We need to rearrange terms in the following way
    \begin{equation}
        \Exp \left[\int_s^t - u(\tau) \sum_{i=1}^N y_i(\tau) + \sum_{i=1}^N \sum_{j=1}^N a_{i j}\left(y_j(\tau)-y_i(\tau)\right)y_i(\tau)- \sum_{i=1}^N c_i y_i(\tau)^2 d\tau \right]
    \end{equation}
    Let us consider the term
    \[
        \sum_{i=1}^N \sum_{j=1}^N a_{i j}\left(y_j(\tau)-y_i(\tau)\right)y_i(\tau)
    \]
    For $i = j$ the term $a_{i j}\left(y_j(\tau)-y_i(\tau)\right)y_i(t) = 0$. For all $i \neq j$ let us cluster the terms in the following pairs:
    \[
         a_{i j}\left(y_j(\tau)-y_i(\tau)\right)y_i(\tau) + a_{j i}\left(y_i(\tau)-y_j(\tau)\right)y_j(\tau) 
    \]
    Note that $a_{ij} = a_{ji}$ by definition of $a_{ij}$, so 
    \begin{multline*}
        a_{i j}\left(y_j(\tau)-y_i(\tau)\right)y_i(\tau) + a_{j i}\left(y_i(\tau)-y_j(t)\right)y_j(\tau)  = \\ 
         a_{i j}\left(y_j(\tau)-y_i(\tau)\right)y_i(\tau) + a_{i j }\left(y_i(\tau)-y_j(\tau)\right)y_j(\tau) = 
         - a_{i j} (y_i(\tau) - y_j(\tau)) ^ 2 \leq 0
    \end{multline*}
    Thus, \eqref{eq:ExpIto} becomes less than 
    \begin{multline*}
        \sum_{i=1}^N \Exp \left[ \int_s^{t} \frac{\sigma_i(\Boldy(\tau))^2}{2} d\tau\right]  +  \Exp \left[\int_s^t - u(\tau) \sum_{i=1}^N y_i(\tau) - \sum_{i=1}^N c_i y_i(\tau)^2 d\tau \right] =  \\ 
        \sum_{i=1}^N \Exp \left[ \int_s^{t} \frac{\sigma_i(\Boldy(\tau))^2}{2} d\tau\right]  +  \Exp \left[\int_s^t - \alpha(\tau) \sum_{i=1}^N \sum_{j=1}^N c_j y_j(\tau) y_i(\tau) - \sum_{i=1}^N c_i y_i(\tau)^2 d\tau \right] = 
    \end{multline*}
    Taking into account that, firstly,
    \begin{multline*}
        -\alpha(\tau) \sum_{i=1}^N \sum_{j=1}^N c_j y_j(\tau) y_i(\tau) \leq \alpha(\tau) \sum_{j=1}^N  c_j N \max_k |y_k(\tau)|^2  \leq  
        \|\Boldy(\tau)\|^2 \alpha(\tau) N \sum_{j=1}^N c_j \leq \\  \|\Boldy(\tau)\|^2  \frac{\gamma \phi(\max_k|y_k(\tau)|)}{2}
    \end{multline*}
    for the choice of $\alpha(\tau)$ and secondly, 
    \[
        c_j = \gamma \phi(|y_j(\tau)|) \geq \gamma \phi(\max_k|y_k(\tau)|) \Longrightarrow \sum_{i=1}^N c_i y_i(\tau)^2 \geq  \|\Boldy(\tau)\|^2  \gamma \phi(\max_k|y_k(\tau)|) 
    \]
    we deduce the following upper bound for  $\Exp \|\Boldy(t)\|^2 - \Exp \|\Boldy(s)\|^2$
    \begin{multline*}
        \Exp \|\Boldy(t)\|^2 - \Exp \|\Boldy(s)\|^2 \leq - \Exp\left[\int_s^t\frac{\gamma \phi(\max_k|y_k(\tau)|)}{2} \|\Boldy(\tau)\|^2 d\tau\right]+ \sum_{i=1}^N \Exp \left[ \int_s^{t} \frac{\sigma_i(\Boldy(\tau))^2}{2} d\tau\right]  \leq \\ 
        - \frac{\gamma \nu }{2} \int_s^t \Exp \|\Boldy(\tau)\|^2 d\tau + \sum_{i=1}^N \Exp \left[ \int_s^{t} \frac{\sigma_i(\Boldy(\tau))^2}{2} d\tau\right] 
    \end{multline*}
    since $\phi(\cdot) \geq \nu > 0$ by definition.
\end{proof}

\begin{corollary}\label{col:derivative}
    \[
        \left[ \Exp \|\Boldy(t)\|^2\right] ' \leq  - \frac{\gamma \nu }{2} \Exp \|\Boldy(t)\|^2   + \sum_{i=1}^N \Exp \left[ \frac{\sigma_i(\Boldy(t))^2}{2} \right]
    \] 
\end{corollary}
\begin{proof}
    Let us put
    \[
        s := t, \quad t := t + \Delta t
    \]
    where $\Delta t > 0$. Thus, we obtain the corollary statement via dividing both sides 
    of inequality from theorem~\ref{thm:global-stabilization} on $\Delta t$ and making $\Delta t \rightarrow 0+$.
    Since the control is smooth the function
    \[
        \Exp \|\Boldy(t)\| ^ 2 
    \]
    is differentiable, which finishes the proof.
\end{proof}
\subsection{Constant noise $\sigma_i(\Boldy(t)) = \sigma = \operatorname*{const}$.}\label{subsec:constant}
According to theorem \ref{thm:global-stabilization} we deduce that
\begin{multline*}
    \Exp \|\Boldy(t)\|^2  - \Exp \|\Boldy(s)\|^2 \leq  \int_s^t N \frac{\sigma^2}{2} - \frac{\gamma \nu }{2} \Exp \|\Boldy(\tau)\|^2 d\tau \Longleftrightarrow \\
    \left(\Exp \|\Boldy(t)\|^2 - N \frac{\sigma^2}{\gamma \nu}\right) - \left(\Exp \|\Boldy(s)\|^2 - N \frac{\sigma^2}{\gamma \nu }\right)  \leq 
     - \frac{\gamma \nu }{2} \int_s^t  \left[\Exp \|\Boldy(\tau)\|^2 - N \frac{\sigma^2}{\gamma \nu } \right] d\tau
\end{multline*}
So if we make the similar steps as in corollary \ref{col:derivative} and apply Gronwall-Bellman Lemma \ref{lemma:gronwall-bellman} to $$ \Exp \|\Boldy(t)\|^2 - N \frac{\sigma^2}{\gamma \nu}$$ we derive 
the following upper bound for $ \Exp \|\Boldy(t)\|^2$: 
\[
    \Exp \|\Boldy(t)\|^2 \leq N \frac{\sigma^2}{\gamma \nu} +  \left(\|\Boldy_0\|^2 - N \frac{\sigma^2}{\gamma \nu }\right) \exp \left\{-\frac{\gamma \nu }{2} t\right\} 
\]
which provide us the limit behaviour for $\Exp \|\Boldy(t)\|^2$. Indeed, the derived upper bound tends to $N \frac{\sigma^2}{\gamma \nu}$ as $t \rightarrow \infty$.

\subsection{Proportional noise $\sigma_i(\Boldy(t)) = \sigma y_i(t)$}\label{subsec:proportional}
According to theorem \ref{thm:global-stabilization} we deduce that
\begin{equation*}
    \Exp \|\Boldy(t)\|^2 -  \Exp\|\Boldy(s)\|^2 \leq   \int_s^t \frac{\sigma^2 - \gamma \nu }{2} \Exp \|\Boldy(\tau)\|^2 d\tau
\end{equation*}
So by applying corollary \ref{col:derivative} and Gronwall-Bellman Lemma \ref{lemma:gronwall-bellman} to $ \Exp \|\Boldy(t)\|^2 $, we derive
\[
    \Exp \|\Boldy(t)\|^2 \leq  \|\Boldy_0\|^2 \exp\left\{\frac{\sigma^2 - \gamma \nu }{2} t \right\}.
\]
In other words, the solution of \eqref{eq:model} is exponentially $p$-stable for $p=2$ if \[\sigma^2 < \gamma \nu\]
\subsection{Bounded noise $\sigma_i(\Boldy(t)) = \sigma h(y_i(t))$}
We assume that $h$ is smooth increasing function with $h(0) = 0$ and $|h(\cdot)| \leq 1$. Thus, there exists $K > 0$ such that
\[
    h(y) \leq K |y|, \quad y \in \Real.
\]
Then, on one hand
\[
    \sum_{i=1}^N \Exp \left[ \int_s^{t} \frac{\sigma_i(\Boldy(\tau))^2}{2} d\tau\right] \leq \frac{\sigma^2 K^2}{2}\int_s^t \Exp \|\Boldy(\tau)\|^2 d \tau 
\]
which provides us (according to subsection \ref{subsec:proportional})
\[
    \Exp \|\Boldy(t)\|^2 \leq  \|\Boldy_0\|^2 \exp\left\{\frac{K^2\sigma^2 - \gamma \nu }{2} t \right\}.
\]
And on the other hand
\begin{equation*}
    \Exp \|\Boldy(t)\|^2  - \Exp \|\Boldy(s)\|^2 \leq  \int_s^t N \frac{\sigma^2}{2} - \frac{\gamma \nu }{2} \Exp \|\Boldy(\tau)\|^2 d\tau
\end{equation*}
which provides us (according to subsection \ref{subsec:constant})
\[
    \Exp \|\Boldy(t)\|^2 \leq N \frac{\sigma^2}{\gamma \nu} +  \left(\|\Boldy_0\|^2 - N \frac{\sigma^2}{\gamma \nu }\right) \exp \left\{-\frac{\gamma \nu }{2} t\right\} 
\]
Thus,
\[
    \Exp \|\Boldy(t)\|^2 \leq \min\left(N \frac{\sigma^2}{\gamma \nu} +  
    \left(\|\Boldy_0\|^2 - N \frac{\sigma^2}{\gamma \nu }\right) \exp \left\{-\frac{\gamma \nu }{2} t\right\},  
    \|\Boldy_0\|^2 \exp\left\{\frac{K^2\sigma^2 - \gamma \nu }{2} t \right\} \right)
\]
Thus, we have exponential stability if $K^2\sigma^2 < \gamma\nu$. Moreover, for small times the bound
\[
    \Exp \|\Boldy(t)\|^2 \leq N \frac{\sigma^2}{\gamma \nu} +  \left(\|\Boldy_0\|^2 - N \frac{\sigma^2}{\gamma \nu }\right) \exp \left\{-\frac{\gamma \nu }{2} t\right\}
\]
guarantees us faster stabilization.
